<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Jxo Hub</title>
<meta name="description" content="Discover apps built on the Jxo platform."/>
<meta name="theme-color" content="#1650DC"/>
<link rel="manifest" href="manifest.json"/>
<link rel="apple-touch-icon" href="icon-192.png"/>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet"/>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}

:root{
  --b0:#0a2e9e;
  --b1:#1650DC;
  --b2:#2060f0;
  --b3:#4d82ff;
  --b4:#a8c4ff;
  --w:#fff;
  --w80:rgba(255,255,255,.80);
  --w50:rgba(255,255,255,.50);
  --w25:rgba(255,255,255,.25);
  --w12:rgba(255,255,255,.12);
  --w08:rgba(255,255,255,.08);
  --w06:rgba(255,255,255,.06);
  --r-md:16px;
  --r-lg:22px;
  --r-xl:28px;
  --r-pill:9999px;
  --s2:0 8px 32px rgba(10,40,160,.32);
  --s3:0 20px 60px rgba(10,40,160,.45);
  --s4:0 40px 100px rgba(8,30,140,.55);
}

body{
  font-family:'Outfit',sans-serif;
  background:var(--b1);
  color:var(--w);
  min-height:100vh;
  overflow-x:hidden;
  -webkit-font-smoothing:antialiased;
}

body::before{
  content:'';
  position:fixed;inset:0;
  background:
    radial-gradient(ellipse 90% 70% at 5%  -5%,  rgba(100,150,255,.40) 0%,transparent 55%),
    radial-gradient(ellipse 60% 50% at 95% 105%, rgba(10,50,200,.60)   0%,transparent 55%),
    radial-gradient(ellipse 55% 60% at 55%  55%,  rgba(12,40,170,.30)  0%,transparent 60%);
  pointer-events:none;
  z-index:0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AUTH SCREEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#auth-screen{
  position:fixed;inset:0;
  display:flex;align-items:center;justify-content:center;
  z-index:900;padding:1.5rem;
}

.auth-glass{
  background:rgba(255,255,255,.10);
  backdrop-filter:blur(48px) saturate(1.8);
  -webkit-backdrop-filter:blur(48px) saturate(1.8);
  border:1px solid var(--w25);
  border-radius:var(--r-xl);
  padding:3rem 2.5rem;
  max-width:400px;width:100%;
  text-align:center;
  box-shadow:var(--s4);
  position:relative;overflow:hidden;
}
.auth-glass::before{
  content:'';position:absolute;top:-100px;left:-100px;
  width:250px;height:250px;
  background:radial-gradient(circle,rgba(255,255,255,.18),transparent 65%);
  pointer-events:none;
}

.auth-logo{display:inline-flex;align-items:center;gap:.55rem;margin-bottom:.5rem;}
.auth-logo-box{
  width:44px;height:44px;background:var(--w);border-radius:12px;
  display:flex;align-items:center;justify-content:center;
  font-size:1.4rem;box-shadow:var(--s2);
}
.auth-logo-text{font-size:2rem;font-weight:900;letter-spacing:-.06em;}
.auth-tag{
  font-family:'Fira Code',monospace;
  font-size:.65rem;letter-spacing:.2em;text-transform:uppercase;
  color:var(--w50);margin-bottom:1.75rem;
}
.auth-desc{color:var(--w50);font-size:.9rem;line-height:1.65;margin-bottom:2rem;}

.btn-signin{
  width:100%;display:inline-flex;align-items:center;justify-content:center;gap:.5rem;
  background:var(--w);color:var(--b1);
  border:none;border-radius:var(--r-pill);
  padding:.9rem 2rem;
  font-family:'Outfit',sans-serif;font-weight:700;font-size:.95rem;
  cursor:pointer;box-shadow:var(--s2);
  transition:transform .15s,box-shadow .15s;
}
.btn-signin:hover{transform:translateY(-2px);box-shadow:var(--s3);}
.btn-signin:active{transform:none;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HEADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#app{display:none;min-height:100vh;position:relative;z-index:1;}

header{
  position:sticky;top:0;z-index:300;
  height:64px;
  display:flex;align-items:center;gap:1rem;
  padding:0 1.5rem;
  background:rgba(22,80,220,.70);
  backdrop-filter:blur(28px) saturate(2);
  -webkit-backdrop-filter:blur(28px) saturate(2);
  border-bottom:1px solid var(--w12);
}

.logo{display:flex;align-items:center;gap:.45rem;text-decoration:none;flex-shrink:0;}
.logo-box{
  width:30px;height:30px;background:var(--w);border-radius:7px;
  display:flex;align-items:center;justify-content:center;font-size:.9rem;
}
.logo-name{font-size:1.05rem;font-weight:800;letter-spacing:-.04em;color:var(--w);}

/* â”€â”€ search trigger in header â”€â”€ */
.search-trigger{
  flex:1;max-width:440px;
  height:38px;
  background:var(--w12);
  border:1.5px solid var(--w25);
  border-radius:var(--r-pill);
  display:flex;align-items:center;gap:.6rem;
  padding:0 1rem 0 .8rem;
  cursor:text;
  transition:background .2s,border-color .2s;
}
.search-trigger:hover{background:var(--w25);border-color:var(--w50);}
.search-trigger-icon{color:var(--w50);line-height:0;flex-shrink:0;}
.search-trigger-icon svg{width:15px;height:15px;}
.search-trigger-text{font-size:.875rem;font-weight:500;color:var(--w50);flex:1;}
.search-trigger-kbd{
  font-family:'Fira Code',monospace;font-size:.6rem;
  background:var(--w12);border-radius:4px;padding:.1rem .35rem;
  color:var(--w25);flex-shrink:0;
}

.hdr-right{margin-left:auto;display:flex;align-items:center;gap:.5rem;flex-shrink:0;}

.user-pill{
  display:flex;align-items:center;gap:.5rem;
  background:var(--w12);border:1.5px solid var(--w25);
  border-radius:var(--r-pill);
  padding:.2rem .8rem .2rem .25rem;
  cursor:pointer;text-decoration:none;color:var(--w);
  transition:background .2s,border-color .2s;
}
.user-pill:hover{background:var(--w25);border-color:var(--w50);}

.av{
  width:26px;height:26px;border-radius:50%;
  background:var(--b3);border:2px solid var(--w25);
  display:flex;align-items:center;justify-content:center;
  font-size:.65rem;font-weight:700;overflow:hidden;flex-shrink:0;
}
.av img{width:100%;height:100%;object-fit:cover;}
.uname{font-size:.8rem;font-weight:600;max-width:100px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}

.btn-out{
  background:none;border:1.5px solid var(--w25);color:var(--w50);
  border-radius:var(--r-pill);padding:.3rem .75rem;
  font-family:'Outfit',sans-serif;font-weight:600;font-size:.75rem;
  cursor:pointer;transition:color .2s,border-color .2s,background .2s;
}
.btn-out:hover{color:var(--w);border-color:var(--w50);background:var(--w06);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SEARCH MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#search-modal{
  display:none;
  position:fixed;inset:0;
  z-index:700;
  background:rgba(8,28,130,.60);
  backdrop-filter:blur(8px);
  -webkit-backdrop-filter:blur(8px);
  align-items:flex-start;
  justify-content:center;
  padding:4.5rem 1.5rem 1.5rem;
}
#search-modal.open{display:flex;}

.sm-card{
  width:100%;max-width:900px;
  background:var(--b0);
  border:1.5px solid var(--w25);
  border-radius:var(--r-xl);
  overflow:hidden;
  box-shadow:var(--s4);
  display:flex;flex-direction:column;
  height:calc(100dvh - 6.5rem);
  max-height:720px;
  animation:sm-in .22s cubic-bezier(.22,1,.36,1) both;
}
@keyframes sm-in{from{opacity:0;transform:scale(.96) translateY(-10px);}to{opacity:1;transform:none;}}

/* search bar inside modal */
.sm-bar{
  display:flex;align-items:center;gap:.7rem;
  padding:.85rem 1.1rem;
  background:var(--w06);
  border-bottom:1px solid var(--w12);
  flex-shrink:0;
}
.sm-bar-icon{color:var(--w50);line-height:0;flex-shrink:0;}
.sm-bar-icon svg{width:16px;height:16px;}

.sm-bar input{
  flex:1;background:none;border:none;outline:none;
  color:var(--w);
  font-family:'Outfit',sans-serif;font-size:.95rem;font-weight:500;
  caret-color:var(--b4);
  min-width:0;
}
.sm-bar input::placeholder{color:var(--w25);}

.sm-esc{
  font-family:'Fira Code',monospace;font-size:.6rem;
  background:var(--w12);border:1px solid var(--w25);border-radius:5px;
  padding:.15rem .45rem;color:var(--w50);flex-shrink:0;cursor:pointer;
}
.sm-esc:hover{background:var(--w25);color:var(--w);}

/* tabs */
.sm-tabs{
  display:flex;border-bottom:1px solid var(--w12);
  flex-shrink:0;padding:0 1.1rem;
}
.sm-tab{
  background:none;border:none;
  color:var(--w50);
  font-family:'Outfit',sans-serif;font-size:.8rem;font-weight:600;
  padding:.6rem .9rem;cursor:pointer;
  border-bottom:2px solid transparent;margin-bottom:-1px;
  transition:color .15s,border-color .15s;
}
.sm-tab.on{color:var(--w);border-color:var(--w);}
.sm-tab:hover:not(.on){color:var(--w80);}

/* panes */
.sm-pane{display:none;flex:1;overflow:hidden;}
.sm-pane.on{display:flex;flex-direction:column;}

/* â”€â”€ Apps pane â”€â”€ */
.sm-apps-scroll{
  flex:1;overflow-y:auto;padding:.75rem 1rem;
  scrollbar-width:thin;scrollbar-color:var(--w12) transparent;
}

.sm-row{
  display:flex;align-items:center;gap:.85rem;
  padding:.7rem .85rem;border-radius:var(--r-md);
  cursor:pointer;
  transition:background .12s;
}
.sm-row:hover{background:var(--w08);}

.sm-ico{
  width:40px;height:40px;border-radius:10px;
  background:var(--b2);border:1px solid var(--w12);
  display:flex;align-items:center;justify-content:center;
  font-size:1.2rem;flex-shrink:0;overflow:hidden;
}
.sm-ico img{width:100%;height:100%;object-fit:cover;border-radius:10px;}

.sm-info{flex:1;min-width:0;}
.sm-name{font-size:.88rem;font-weight:700;letter-spacing:-.02em;
  overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.sm-meta{font-family:'Fira Code',monospace;font-size:.62rem;color:var(--b4);}

.sm-arr{color:var(--w25);font-size:.8rem;flex-shrink:0;}
.sm-row:hover .sm-arr{color:var(--w80);}

.sm-empty{text-align:center;padding:3rem 1rem;color:var(--w50);font-size:.85rem;}

.sm-no-query{
  display:flex;flex-direction:column;align-items:center;
  justify-content:center;height:100%;gap:.5rem;
  color:var(--w25);
}
.sm-no-query-icon{font-size:2rem;margin-bottom:.25rem;}
.sm-no-query p{font-size:.8rem;font-family:'Fira Code',monospace;}

/* â”€â”€ Web pane â”€â”€ */
.sm-web{flex:1;position:relative;overflow:hidden;}

#search-iframe{
  position:absolute;inset:0;
  width:100%;height:100%;
  border:none;display:block;
}

.sm-web-prompt{
  display:flex;flex-direction:column;align-items:center;
  justify-content:center;height:100%;gap:.6rem;
  color:var(--w50);text-align:center;padding:2rem;
}
.sm-web-prompt-icon{font-size:2.5rem;margin-bottom:.4rem;}
.sm-web-prompt p{font-size:.85rem;line-height:1.55;}
.sm-web-prompt small{
  font-family:'Fira Code',monospace;font-size:.65rem;color:var(--w25);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAIN CONTENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
main{max-width:1180px;margin:0 auto;padding:2.25rem 1.5rem 9rem;}

.hero{
  background:var(--w06);border:1px solid var(--w12);
  border-radius:var(--r-xl);
  padding:3.5rem 3rem;
  margin-bottom:2.5rem;
  position:relative;overflow:hidden;
}
.hero-glow{
  position:absolute;top:-80px;right:-80px;
  width:300px;height:300px;border-radius:50%;
  background:radial-gradient(circle,rgba(120,160,255,.22),transparent 68%);
  pointer-events:none;
}
.hero-pill{
  display:inline-flex;align-items:center;gap:.4rem;
  background:var(--w12);border:1px solid var(--w25);
  border-radius:var(--r-pill);
  padding:.2rem .75rem;
  font-family:'Fira Code',monospace;font-size:.62rem;
  letter-spacing:.14em;text-transform:uppercase;color:var(--w80);
  margin-bottom:1.2rem;
}
.hero-dot{
  width:6px;height:6px;border-radius:50%;background:#6dffa0;
  animation:blink-dot 2.2s ease-in-out infinite;
}
@keyframes blink-dot{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.4;transform:scale(.8)}}
.hero h1{
  font-size:clamp(2rem,5vw,3.6rem);
  font-weight:900;letter-spacing:-.06em;line-height:1.03;margin-bottom:.7rem;
}
.hero h1 em{font-style:normal;color:var(--b4);}
.hero p{color:var(--w50);font-size:.95rem;line-height:1.65;max-width:400px;}

/* section label */
.sec-row{display:flex;align-items:center;gap:.7rem;margin-bottom:1.2rem;}
.sec-label{
  font-family:'Fira Code',monospace;
  font-size:.62rem;letter-spacing:.18em;text-transform:uppercase;color:var(--w50);
  white-space:nowrap;
}
.sec-line{flex:1;height:1px;background:var(--w12);}
.sec-badge{
  background:var(--w12);border-radius:var(--r-pill);
  padding:.1rem .55rem;
  font-family:'Fira Code',monospace;font-size:.62rem;color:var(--w50);
}

/* apps grid */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(236px,1fr));
  gap:1rem;
}

.skel{
  background:var(--w06);border:1px solid var(--w12);
  border-radius:var(--r-lg);padding:1.5rem;
  animation:skel-p 1.7s ease-in-out infinite;
}
@keyframes skel-p{0%,100%{opacity:.5}50%{opacity:.85}}
.skel-b{background:var(--w12);border-radius:5px;margin-bottom:.7rem;}

.card{
  background:var(--w06);border:1px solid var(--w12);
  border-radius:var(--r-lg);padding:1.5rem;
  cursor:pointer;position:relative;overflow:hidden;
  transition:background .18s,border-color .18s,transform .18s,box-shadow .18s;
  animation:card-in .35s cubic-bezier(.22,1,.36,1) both;
}
@keyframes card-in{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:none}}
.card:hover{background:var(--w12);border-color:var(--w25);transform:translateY(-3px);box-shadow:var(--s2);}
.card-arrow{
  position:absolute;top:1.2rem;right:1.2rem;
  color:var(--w50);font-size:.85rem;
  opacity:0;transform:translate(-2px,2px);
  transition:opacity .18s,transform .18s;
}
.card:hover .card-arrow{opacity:1;transform:none;}
.card-icon{
  width:50px;height:50px;border-radius:13px;
  background:var(--b2);border:1px solid var(--w12);
  display:flex;align-items:center;justify-content:center;
  font-size:1.5rem;margin-bottom:.95rem;overflow:hidden;flex-shrink:0;
}
.card-icon img{width:100%;height:100%;object-fit:cover;border-radius:13px;}
.card-name{font-size:1rem;font-weight:700;letter-spacing:-.03em;margin-bottom:.2rem;}
.card-author{font-family:'Fira Code',monospace;font-size:.65rem;color:var(--b4);margin-bottom:.6rem;}
.card-desc{font-size:.82rem;color:var(--w50);line-height:1.55;
  display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;}
.empty{grid-column:1/-1;text-align:center;padding:4rem 1rem;color:var(--w50);}
.empty-icon{font-size:2.5rem;margin-bottom:.75rem;}
.empty p{font-size:.88rem;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   OZO FAB
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#ozo-fab{
  position:fixed;bottom:1.75rem;right:1.75rem;z-index:600;
  width:54px;height:54px;border-radius:50%;
  background:var(--w);border:none;cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  box-shadow:var(--s3);
  transition:transform .2s cubic-bezier(.34,1.56,.64,1),box-shadow .2s;
}
#ozo-fab:hover{transform:scale(1.12);box-shadow:var(--s4);}
#ozo-fab svg{width:28px;height:28px;display:block;}
.fab-dot{
  position:absolute;top:-2px;right:-2px;
  width:13px;height:13px;border-radius:50%;
  background:#6dffa0;border:2.5px solid var(--b1);
}

#ozo-tip{
  position:fixed;bottom:2rem;right:5rem;z-index:600;
  background:var(--w);color:var(--b1);
  border-radius:var(--r-pill);padding:.38rem .9rem;
  font-size:.76rem;font-weight:700;white-space:nowrap;
  box-shadow:var(--s2);pointer-events:none;
  opacity:0;transform:translateX(6px);
  transition:opacity .2s,transform .2s;
}
#ozo-fab:hover~#ozo-tip{opacity:1;transform:none;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   OZO PANEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#ozo-panel{
  position:fixed;bottom:5.5rem;right:1.75rem;z-index:590;
  width:390px;height:580px;
  max-width:calc(100vw - 3.5rem);max-height:calc(100dvh - 8rem);
  display:none;flex-direction:column;
  border-radius:var(--r-xl);overflow:hidden;
  box-shadow:var(--s4);border:1.5px solid var(--w25);
}
#ozo-panel.open{display:flex;animation:pop-in .28s cubic-bezier(.34,1.56,.64,1) both;}
@keyframes pop-in{from{opacity:0;transform:scale(.88) translateY(14px);}to{opacity:1;transform:none;}}

.ozo-bar{
  display:flex;align-items:center;gap:.6rem;
  padding:.8rem 1rem;background:var(--b0);
  border-bottom:1px solid var(--w12);flex-shrink:0;
}
.ozo-av{
  width:30px;height:30px;border-radius:50%;
  background:linear-gradient(135deg,var(--b4),#6dffa0);
  display:flex;align-items:center;justify-content:center;
  font-size:.85rem;font-weight:900;color:var(--b0);flex-shrink:0;
}
.ozo-info{flex:1;min-width:0;}
.ozo-name{font-size:.84rem;font-weight:700;line-height:1;}
.ozo-status{font-family:'Fira Code',monospace;font-size:.58rem;color:#6dffa0;letter-spacing:.06em;}
.ozo-close{
  width:28px;height:28px;border-radius:50%;
  background:var(--w12);border:none;
  color:var(--w50);font-size:1.1rem;line-height:1;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;transition:background .15s,color .15s;
}
.ozo-close:hover{background:var(--w25);color:var(--w);}

#ozo-iframe{flex:1;width:100%;border:none;display:block;background:var(--b1);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INSTALL BANNER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#install-banner{
  display:none;position:fixed;bottom:0;left:0;right:0;z-index:400;
  align-items:center;gap:1rem;padding:1rem 1.5rem;
  background:rgba(13,58,181,.94);backdrop-filter:blur(16px);
  border-top:1px solid var(--w12);
}
#install-banner p{flex:1;font-size:.85rem;color:var(--w50);}
#install-banner p strong{color:var(--w);}
.btn-install{
  background:var(--w);color:var(--b1);border:none;border-radius:var(--r-pill);
  padding:.55rem 1.25rem;
  font-family:'Outfit',sans-serif;font-weight:700;font-size:.82rem;
  cursor:pointer;white-space:nowrap;transition:opacity .15s;
}
.btn-install:hover{opacity:.88;}
.btn-x{background:none;border:none;color:var(--w50);font-size:1.3rem;cursor:pointer;transition:color .15s;}
.btn-x:hover{color:var(--w);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BAN SCREEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#ban-screen{
  position:fixed;inset:0;
  display:none;
  align-items:center;justify-content:center;
  z-index:950;padding:1.5rem;
  background:var(--b1);
}
#ban-screen::before{
  content:'';position:fixed;inset:0;
  background:
    radial-gradient(ellipse 80% 60% at 10% 5%,  rgba(255,80,80,.18) 0%,transparent 55%),
    radial-gradient(ellipse 60% 50% at 90% 95%, rgba(180,20,20,.30)  0%,transparent 55%);
  pointer-events:none;
}

.ban-card{
  background:rgba(255,255,255,.08);
  backdrop-filter:blur(48px) saturate(1.6);
  -webkit-backdrop-filter:blur(48px) saturate(1.6);
  border:1px solid rgba(255,120,120,.30);
  border-radius:var(--r-xl);
  padding:3rem 2.5rem;
  max-width:440px;width:100%;
  text-align:center;
  box-shadow:0 40px 100px rgba(180,20,20,.35);
  position:relative;overflow:hidden;
}
.ban-card::before{
  content:'';position:absolute;top:-80px;left:-80px;
  width:220px;height:220px;
  background:radial-gradient(circle,rgba(255,100,100,.12),transparent 65%);
  pointer-events:none;
}

.ban-icon{
  font-size:3rem;margin-bottom:1rem;
  display:block;
  animation:ban-icon-in .5s cubic-bezier(.34,1.56,.64,1) both;
}
@keyframes ban-icon-in{from{opacity:0;transform:scale(.5) rotate(-15deg);}to{opacity:1;transform:none;}}

.ban-title{
  font-size:1.6rem;font-weight:900;letter-spacing:-.05em;
  margin-bottom:.4rem;color:var(--w);
}

.ban-sub{
  font-family:'Fira Code',monospace;
  font-size:.65rem;letter-spacing:.18em;text-transform:uppercase;
  color:rgba(255,150,150,.7);margin-bottom:1.5rem;
}

.ban-reason-box{
  background:rgba(255,80,80,.10);
  border:1px solid rgba(255,120,120,.20);
  border-radius:var(--r-md);
  padding:1rem 1.25rem;
  margin-bottom:1.75rem;
  text-align:left;
}
.ban-reason-label{
  font-family:'Fira Code',monospace;
  font-size:.6rem;letter-spacing:.15em;text-transform:uppercase;
  color:rgba(255,150,150,.6);margin-bottom:.4rem;
}
.ban-reason-text{
  font-size:.88rem;line-height:1.55;color:var(--w80);
}

.ban-email{
  font-family:'Fira Code',monospace;
  font-size:.72rem;color:rgba(255,255,255,.35);
  margin-bottom:1.5rem;
}

.btn-ban-signout{
  display:inline-flex;align-items:center;justify-content:center;gap:.45rem;
  background:rgba(255,255,255,.12);
  border:1px solid rgba(255,255,255,.20);
  color:var(--w80);
  border-radius:var(--r-pill);
  padding:.75rem 1.75rem;
  font-family:'Outfit',sans-serif;font-weight:600;font-size:.88rem;
  cursor:pointer;
  transition:background .2s,color .2s;width:100%;
}
.btn-ban-signout:hover{background:rgba(255,255,255,.20);color:var(--w);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOBILE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media(max-width:600px){
  header{padding:0 1rem;}
  .search-trigger-kbd{display:none;}
  main{padding:1.5rem 1rem 9rem;}
  .hero{padding:2rem 1.5rem;}
  #ozo-panel{right:0;bottom:0;width:100vw;max-width:100vw;height:100dvh;max-height:100dvh;border-radius:0;border:none;}
  #search-modal{padding:3.5rem 0 0;}
  .sm-card{border-radius:var(--r-xl) var(--r-xl) 0 0;max-height:none;height:calc(100dvh - 3.5rem);}
}
</style>
</head>
<body>

<!-- â”€â”€ AUTH â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div id="auth-screen">
  <div class="auth-glass">
    <div class="auth-logo">
      <div class="auth-logo-box">ğŸš€</div>
      <span class="auth-logo-text">JxoHub</span>
    </div>
    <div class="auth-tag">App Discovery Platform</div>
    <p class="auth-desc">Sign in with your Jxo account to browse and launch apps from the Jxo ecosystem.</p>
    <button class="btn-signin" onclick="Jxo.login()">
      <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
        <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/>
        <polyline points="10 17 15 12 10 7"/>
        <line x1="15" y1="12" x2="3" y2="12"/>
      </svg>
      Sign in with Jxo
    </button>
  </div>
</div>

<!-- â”€â”€ BAN SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div id="ban-screen">
  <div class="ban-card">
    <span class="ban-icon">ğŸš«</span>
    <div class="ban-title">Access Denied</div>
    <div class="ban-sub">Your account has been banned</div>
    <div class="ban-reason-box">
      <div class="ban-reason-label">Reason</div>
      <div class="ban-reason-text" id="ban-reason-text">You have been banned from Jxo Hub.</div>
    </div>
    <div class="ban-email" id="ban-email-text"></div>
    <button class="btn-ban-signout" onclick="doBanSignOut()">
      <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
        <polyline points="16 17 21 12 16 7"/>
        <line x1="21" y1="12" x2="9" y2="12"/>
      </svg>
      Sign out
    </button>
  </div>
</div>

<!-- â”€â”€ APP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div id="app">

  <header>
    <a class="logo" href="#">
      <div class="logo-box">ğŸš€</div>
      <span class="logo-name">JxoHub</span>
    </a>

    <!-- clicking this opens the search modal -->
    <div class="search-trigger" id="search-trigger" role="button" tabindex="0" aria-label="Open search">
      <span class="search-trigger-icon">
        <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
          <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
        </svg>
      </span>
      <span class="search-trigger-text">Search apps &amp; the webâ€¦</span>
      <span class="search-trigger-kbd">âŒ˜K</span>
    </div>

    <div class="hdr-right">
      <div class="user-pill" onclick="Jxo.openAccountManager()">
        <div class="av" id="av"><span id="av-init">?</span></div>
        <span class="uname" id="uname">â€¦</span>
      </div>
      <button class="btn-out" onclick="doSignOut()">Sign out</button>
    </div>
  </header>

  <!-- â”€â”€ SEARCH MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="search-modal" role="dialog" aria-modal="true" aria-label="Search">
    <div class="sm-card">

      <!-- input bar -->
      <div class="sm-bar">
        <span class="sm-bar-icon">
          <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
            <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
          </svg>
        </span>
        <input id="sm-input" type="text" placeholder="Search apps or anything on the webâ€¦" autocomplete="off" spellcheck="false"/>
        <button class="sm-esc" onclick="closeSearch()" title="Close (Esc)">esc</button>
      </div>

      <!-- tabs -->
      <div class="sm-tabs">
        <button class="sm-tab on" id="tab-apps" onclick="switchTab('apps')">Apps</button>
        <button class="sm-tab" id="tab-web"  onclick="switchTab('web')">Jxo Web Search</button>
        <button class="sm-tab" id="tab-ozo"  onclick="switchTab('ozo')">âœ¦ Ozo AI</button>
      </div>

      <!-- Apps pane -->
      <div class="sm-pane on" id="pane-apps">
        <div class="sm-apps-scroll" id="sm-apps-list">
          <div class="sm-no-query">
            <div class="sm-no-query-icon">ğŸ”</div>
            <p>Start typing to search appsâ€¦</p>
          </div>
        </div>
      </div>

      <!-- Web pane -->
      <div class="sm-pane" id="pane-web">
        <div class="sm-web">
          <div class="sm-web-prompt" id="web-prompt">
            <div class="sm-web-prompt-icon">ğŸŒ</div>
            <p>Type a query and switch to this tab<br/>to search the Jxo web index.</p>
            <small>Powered by jxoj.github.io/Jxo</small>
          </div>
          <!-- iframe is injected into .sm-web dynamically -->
        </div>
      </div>

      <!-- Ozo pane -->
      <div class="sm-pane" id="pane-ozo">
        <iframe
          id="ozo-search-iframe"
          src="about:blank"
          allow="microphone; camera; autoplay; clipboard-read; clipboard-write; fullscreen"
          referrerpolicy="no-referrer-when-downgrade"
          style="flex:1;width:100%;border:none;display:block;"
        ></iframe>
      </div>

    </div>
  </div>
  <!-- backdrop click closes modal -->
  <script>document.getElementById('search-modal').addEventListener('click',function(e){if(e.target===this)closeSearch();});</script>

  <!-- â”€â”€ MAIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <main>
    <section class="hero">
      <div class="hero-glow"></div>
      <div class="hero-pill"><span class="hero-dot"></span> Jxo Ecosystem</div>
      <h1>Discover <em>apps</em><br/>built on Jxo.</h1>
      <p>Curated tools and experiences from the community. One click to launch.</p>
    </section>

    <div class="sec-row">
      <span class="sec-label" id="apps-label">All Apps</span>
      <div class="sec-line"></div>
      <span class="sec-badge" id="apps-count">â€”</span>
    </div>

    <div class="grid" id="grid">
      <div class="skel"><div class="skel-b" style="width:50px;height:50px;border-radius:13px;margin-bottom:.95rem;"></div><div class="skel-b" style="width:62%;height:12px;"></div><div class="skel-b" style="width:38%;height:9px;"></div><div class="skel-b" style="width:88%;height:9px;"></div><div class="skel-b" style="width:72%;height:9px;"></div></div>
      <div class="skel"><div class="skel-b" style="width:50px;height:50px;border-radius:13px;margin-bottom:.95rem;"></div><div class="skel-b" style="width:50%;height:12px;"></div><div class="skel-b" style="width:32%;height:9px;"></div><div class="skel-b" style="width:92%;height:9px;"></div><div class="skel-b" style="width:68%;height:9px;"></div></div>
      <div class="skel"><div class="skel-b" style="width:50px;height:50px;border-radius:13px;margin-bottom:.95rem;"></div><div class="skel-b" style="width:72%;height:12px;"></div><div class="skel-b" style="width:45%;height:9px;"></div><div class="skel-b" style="width:80%;height:9px;"></div><div class="skel-b" style="width:60%;height:9px;"></div></div>
      <div class="skel"><div class="skel-b" style="width:50px;height:50px;border-radius:13px;margin-bottom:.95rem;"></div><div class="skel-b" style="width:56%;height:12px;"></div><div class="skel-b" style="width:28%;height:9px;"></div><div class="skel-b" style="width:84%;height:9px;"></div><div class="skel-b" style="width:76%;height:9px;"></div></div>
    </div>
  </main>

  <!-- OZO FAB -->
  <button id="ozo-fab" onclick="toggleOzo()" aria-label="Open Ozo AI">
    <div class="fab-dot"></div>
    <svg viewBox="0 0 54 54" fill="none">
      <circle cx="27" cy="27" r="27" fill="#1650DC"/>
      <path d="M27 10 L29.5 24 L43 27 L29.5 30 L27 44 L24.5 30 L11 27 L24.5 24 Z" fill="white"/>
      <circle cx="36" cy="17" r="2" fill="white" opacity=".65"/>
      <circle cx="16" cy="38" r="1.4" fill="white" opacity=".45"/>
    </svg>
  </button>
  <div id="ozo-tip">Ask Ozo AI</div>

  <!-- OZO PANEL -->
  <div id="ozo-panel">
    <div class="ozo-bar">
      <div class="ozo-av">O</div>
      <div class="ozo-info">
        <div class="ozo-name">Ozo</div>
        <div class="ozo-status">â— online</div>
      </div>
      <button class="ozo-close" onclick="toggleOzo()" aria-label="Close">&#x2715;</button>
    </div>
    <iframe id="ozo-iframe" src="about:blank" allow="microphone; camera; autoplay; clipboard-read; clipboard-write; fullscreen" referrerpolicy="no-referrer-when-downgrade"></iframe>
  </div>

  <!-- INSTALL BANNER -->
  <div id="install-banner">
    <p><strong>Install Jxo Hub</strong> â€” Add to home screen for the best experience.</p>
    <button class="btn-install" id="btn-install">Install</button>
    <button class="btn-x" onclick="dismissInstall()">&#x2715;</button>
  </div>

</div><!-- /#app -->

<script src="https://jxoj.github.io/Jxo/sdk.js"></script>
<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONSTANTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
var SESSION_KEY = 'jxo_hub_session'; // localStorage key for cached user

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
var allApps   = [];
var ozoOpen   = false;
var ozoLoaded = false;
var deferredPrompt = null;
var activeTab = 'apps';
var searchIframeLoaded = false;
var lastWebQuery = '';

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BOOT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
(async function boot() {
  var cached = restoreSession();

  try {
    await Jxo.init('com.jxo.hub');
  } catch(e) {
    console.warn('SDK init:', e);
  }

  var user = Jxo.isAuthenticated() ? Jxo.getUser() : cached;

  if (!user) {
    // Not signed in at all
    document.getElementById('auth-screen').style.display = 'flex';
    return;
  }

  // â”€â”€ Ban check â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  var ban = await checkBan(user.email);
  if (ban) {
    showBanScreen(user.email, ban.reason);
    return;
  }

  // â”€â”€ All clear â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (Jxo.isAuthenticated()) {
    saveSession(user);
    showApp();
  } else {
    // Cached session, no live token
    showApp(cached);
    setTimeout(function() {
      if (!Jxo.isAuthenticated()) showReauthNudge();
    }, 3000);
  }
})();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BAN CHECK
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function checkBan(email) {
  if (!email) return null;
  try {
    var res = await fetch('https://usejxo.github.io/Jxo-Hub/bans.json', { cache: 'no-store' });
    if (!res.ok) return null; // Can't load bans â†’ don't block anyone
    var data = await res.json();
    var rules = data.bans || [];
    var lowerEmail = email.toLowerCase();

    for (var i = 0; i < rules.length; i++) {
      var rule = rules[i];
      // Support both exact email match and substring/wildcard pattern
      var pattern = (rule.email || rule.pattern || '').toLowerCase();
      if (!pattern) continue;
      if (lowerEmail === pattern || lowerEmail.includes(pattern)) {
        return { reason: rule.reason || 'No reason provided.' };
      }
    }
    return null;
  } catch(e) {
    // Network error â†’ fail open (don't ban)
    console.warn('Ban check failed, failing open:', e);
    return null;
  }
}

function showBanScreen(email, reason) {
  document.getElementById('auth-screen').style.display = 'none';
  document.getElementById('app').style.display = 'none';
  document.getElementById('ban-reason-text').textContent = reason;
  document.getElementById('ban-email-text').textContent = email;
  document.getElementById('ban-screen').style.display = 'flex';
}

function doBanSignOut() {
  clearSession();
  if (Jxo.isAuthenticated()) Jxo.signOut();
  // Reload to show auth screen
  location.reload();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SESSION PERSISTENCE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function saveSession(user) {
  if (!user) return;
  try {
    localStorage.setItem(SESSION_KEY, JSON.stringify({
      uid: user.uid,
      email: user.email,
      displayName: user.displayName,
      photoURL: user.photoURL,
      emailVerified: user.emailVerified,
      savedAt: Date.now()
    }));
  } catch(e) {}
}

function restoreSession() {
  try {
    var raw = localStorage.getItem(SESSION_KEY);
    if (!raw) return null;
    var data = JSON.parse(raw);
    // Expire after 30 days
    if (Date.now() - data.savedAt > 30 * 24 * 60 * 60 * 1000) {
      localStorage.removeItem(SESSION_KEY);
      return null;
    }
    return data;
  } catch(e) { return null; }
}

function clearSession() {
  try { localStorage.removeItem(SESSION_KEY); } catch(e) {}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SHOW APP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showApp(cachedUser) {
  document.getElementById('auth-screen').style.display = 'none';
  document.getElementById('app').style.display = 'block';

  // Use live user if available, fall back to cached
  var user = Jxo.isAuthenticated() ? Jxo.getUser() : cachedUser;
  if (user) populateUser(user);

  fetchApps();
  initSearch();
  initKeyboard();
  registerSW();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   USER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function populateUser(user) {
  var name = user.displayName || user.email || 'User';
  document.getElementById('uname').textContent = name.split(' ')[0];
  var avEl = document.getElementById('av');
  if (user.photoURL) {
    var init = name[0].toUpperCase();
    avEl.innerHTML = '<img src="' + h(user.photoURL) + '" alt="' + h(name) + '" onerror="this.outerHTML=\'<span>' + init + '</span>\'">';
  } else {
    document.getElementById('av-init').textContent = name[0].toUpperCase();
  }
}

function doSignOut() {
  clearSession();
  Jxo.signOut();
  location.reload();
}

/* re-auth nudge â€” subtle banner, not a gate */
function showReauthNudge() {
  var nudge = document.createElement('div');
  nudge.style.cssText = [
    'position:fixed;top:70px;left:50%;transform:translateX(-50%);',
    'background:rgba(10,46,158,.95);border:1px solid rgba(255,255,255,.25);',
    'border-radius:9999px;padding:.45rem 1.1rem;z-index:500;',
    'font-size:.75rem;color:rgba(255,255,255,.7);',
    'display:flex;align-items:center;gap:.65rem;',
    'box-shadow:0 8px 32px rgba(10,40,160,.4);',
    'animation:card-in .3s ease both;'
  ].join('');
  nudge.innerHTML = [
    '<span>Session may have expired â€”</span>',
    '<a href="#" onclick="Jxo.login();return false;" style="color:#a8c4ff;font-weight:700;text-decoration:none;">',
    'Refresh sign-in</a>',
    '<button onclick="this.parentElement.remove()" style="background:none;border:none;color:rgba(255,255,255,.4);cursor:pointer;font-size:1rem;">Ã—</button>'
  ].join('');
  document.body.appendChild(nudge);
  setTimeout(function(){ if(nudge.parentNode) nudge.remove(); }, 8000);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   APPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function fetchApps() {
  try {
    var res = await fetch('https://usejxo.github.io/Jxo-Hub/apps.json');
    if (!res.ok) throw 0;
    var data = await res.json();
    allApps = data.apps || [];
    renderApps(allApps);
  } catch(_) {
    renderError();
  }
}

function renderApps(list) {
  var grid  = document.getElementById('grid');
  var count = document.getElementById('apps-count');
  count.textContent = list.length;
  if (!list.length) {
    grid.innerHTML = '<div class="empty"><div class="empty-icon">ğŸ”</div><p>No apps found.</p></div>';
    return;
  }
  grid.innerHTML = list.map(function(app, i) {
    return '<div class="card" style="animation-delay:' + (i * 0.045) + 's" onclick="openApp(\'' + h(app.url) + '\')">' +
      '<div class="card-arrow">â†—</div>' +
      '<div class="card-icon">' +
        (app.icon ? '<img src="' + h(app.icon) + '" alt="' + h(app.name) + '" onerror="this.outerHTML=\'ğŸ“¦\'">' : 'ğŸ“¦') +
      '</div>' +
      '<div class="card-name">'   + esc(app.name)        + '</div>' +
      '<div class="card-author">by ' + esc(app.author)   + '</div>' +
      '<div class="card-desc">'   + esc(app.description) + '</div>' +
    '</div>';
  }).join('');
}

function renderError() {
  document.getElementById('grid').innerHTML =
    '<div class="empty"><div class="empty-icon">ğŸ“¡</div><p>Could not load apps.</p></div>';
  document.getElementById('apps-count').textContent = '!';
}

function openApp(url) { window.open(url, '_blank', 'noopener,noreferrer'); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SEARCH MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function openSearch() {
  document.getElementById('search-modal').classList.add('open');
  setTimeout(function(){ document.getElementById('sm-input').focus(); }, 50);
}

function closeSearch() {
  document.getElementById('search-modal').classList.remove('open');
}

function initSearch() {
  // Trigger from header bar
  var trigger = document.getElementById('search-trigger');
  trigger.addEventListener('click', openSearch);
  trigger.addEventListener('keydown', function(e){ if(e.key==='Enter'||e.key===' ') openSearch(); });

  // Live search as user types
  var inp = document.getElementById('sm-input');
  var debounce;
  inp.addEventListener('input', function() {
    clearTimeout(debounce);
    var q = inp.value.trim();
    updateAppsPane(q);
    debounce = setTimeout(function(){ updateWebPane(q); }, 400);
  });
}

function initKeyboard() {
  document.addEventListener('keydown', function(e) {
    // âŒ˜K or Ctrl+K
    if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
      e.preventDefault();
      openSearch();
    }
    // Escape
    if (e.key === 'Escape') {
      closeSearch();
    }
  });
}

/* â”€â”€ Tab switching â”€â”€ */
var ozoSearchLoaded = false;
function switchTab(tab) {
  activeTab = tab;
  ['apps','web','ozo'].forEach(function(t) {
    document.getElementById('tab-' + t).classList.toggle('on', tab === t);
    document.getElementById('pane-' + t).classList.toggle('on', tab === t);
  });

  var q = document.getElementById('sm-input').value.trim();

  if (tab === 'web' && q) {
    loadSearchIframe(q);
  }

  if (tab === 'ozo' && !ozoSearchLoaded) {
    document.getElementById('ozo-search-iframe').src = 'https://jxoj.github.io/Ozo';
    ozoSearchLoaded = true;
  }
}

/* â”€â”€ Apps pane updates â”€â”€ */
function updateAppsPane(q) {
  var container = document.getElementById('sm-apps-list');

  if (!q) {
    container.innerHTML = '<div class="sm-no-query"><div class="sm-no-query-icon">ğŸ”</div><p>Start typing to search appsâ€¦</p></div>';
    return;
  }

  var lq = q.toLowerCase();
  var results = allApps.filter(function(a) {
    return (a.name + ' ' + a.description + ' ' + a.author).toLowerCase().includes(lq);
  });

  if (!results.length) {
    container.innerHTML = '<div class="sm-empty">No matching apps found for "<strong>' + esc(q) + '</strong>"</div>';
    return;
  }

  container.innerHTML = results.map(function(app) {
    return '<div class="sm-row" onclick="openApp(\'' + h(app.url) + '\')">' +
      '<div class="sm-ico">' +
        (app.icon ? '<img src="' + h(app.icon) + '" alt="' + h(app.name) + '" onerror="this.outerHTML=\'ğŸ“¦\'">' : 'ğŸ“¦') +
      '</div>' +
      '<div class="sm-info">' +
        '<div class="sm-name">' + esc(app.name) + '</div>' +
        '<div class="sm-meta">by ' + esc(app.author) + '</div>' +
      '</div>' +
      '<span class="sm-arr">â†—</span>' +
    '</div>';
  }).join('');
}

/* â”€â”€ Web pane â”€â”€ */
function updateWebPane(q) {
  // Auto-load if already on web tab
  if (activeTab === 'web' && q) {
    loadSearchIframe(q);
  }
  // If on apps tab, update tab label to hint
  var webTab = document.getElementById('tab-web');
  if (q) {
    webTab.textContent = 'Jxo Web: "' + (q.length > 20 ? q.slice(0, 20) + 'â€¦' : q) + '"';
  } else {
    webTab.textContent = 'Jxo Web Search';
    // Clear web pane back to placeholder
    showWebPrompt();
  }
}

function loadSearchIframe(q) {
  if (q === lastWebQuery && searchIframeLoaded) return;
  lastWebQuery = q;

  var webWrap = document.querySelector('.sm-web');

  // Remove old iframe and prompt
  var oldIframe = document.getElementById('search-iframe');
  var oldPrompt = document.getElementById('web-prompt');
  if (oldIframe) oldIframe.remove();
  if (oldPrompt) oldPrompt.remove();

  // Create fresh iframe
  var iframe = document.createElement('iframe');
  iframe.id = 'search-iframe';
  iframe.src = 'https://jxoj.github.io/Jxo?q=' + encodeURIComponent(q);
  iframe.allow = 'autoplay; clipboard-read; clipboard-write; fullscreen';
  iframe.referrerPolicy = 'no-referrer-when-downgrade';
  iframe.style.cssText = 'position:absolute;inset:0;width:100%;height:100%;border:none;display:block;';
  webWrap.appendChild(iframe);
  searchIframeLoaded = true;
}

function showWebPrompt() {
  var webWrap = document.querySelector('.sm-web');
  var oldIframe = document.getElementById('search-iframe');
  if (oldIframe) oldIframe.remove();
  searchIframeLoaded = false;
  lastWebQuery = '';

  if (!document.getElementById('web-prompt')) {
    var prompt = document.createElement('div');
    prompt.id = 'web-prompt';
    prompt.className = 'sm-web-prompt';
    prompt.innerHTML = [
      '<div class="sm-web-prompt-icon">ğŸŒ</div>',
      '<p>Type a query and switch to this tab<br/>to search the Jxo web index.</p>',
      '<small>Powered by jxoj.github.io/Jxo</small>'
    ].join('');
    webWrap.appendChild(prompt);
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   OZO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function toggleOzo() {
  var panel  = document.getElementById('ozo-panel');
  var iframe = document.getElementById('ozo-iframe');
  ozoOpen = !ozoOpen;
  if (ozoOpen) {
    if (!ozoLoaded) {
      iframe.src = 'https://jxoj.github.io/Ozo?minimode';
      ozoLoaded = true;
    }
    panel.classList.add('open');
  } else {
    panel.classList.remove('open');
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PWA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
window.addEventListener('beforeinstallprompt', function(e) {
  e.preventDefault();
  deferredPrompt = e;
  if (!sessionStorage.getItem('jxo-no-install'))
    document.getElementById('install-banner').style.display = 'flex';
});

document.getElementById('btn-install').addEventListener('click', async function() {
  if (!deferredPrompt) return;
  deferredPrompt.prompt();
  var r = await deferredPrompt.userChoice;
  if (r.outcome === 'accepted') dismissInstall();
  deferredPrompt = null;
});

function dismissInstall() {
  document.getElementById('install-banner').style.display = 'none';
  sessionStorage.setItem('jxo-no-install', '1');
}

function registerSW() {
  if ('serviceWorker' in navigator) navigator.serviceWorker.register('sw.js').catch(function(){});
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UTILS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function esc(s) {
  return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}
function h(s) { return String(s).replace(/"/g,'&quot;').replace(/'/g,'&#39;'); }
</script>
</body>
</html>